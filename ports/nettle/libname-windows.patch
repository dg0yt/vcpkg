diff --git a/Makefile.in b/Makefile.in
index 8599c97..370ff86 100644
--- a/Makefile.in
+++ b/Makefile.in
@@ -29,8 +29,9 @@ include config.make
 PRE_CPPFLAGS = -I.
 EXTRA_CFLAGS = $(CCPIC)
 
-LIBTARGETS = @IF_STATIC@ libnettle.a @IF_HOGWEED@ libhogweed.a
+LIBTARGETS = @IF_STATIC@ @LIBNETTLE_ARCHIVE@ @IF_HOGWEED@ @LIBHOGWEED_ARCHIVE@
 SHLIBTARGETS = @IF_SHARED@ $(LIBNETTLE_FORLINK) @IF_HOGWEED@ $(LIBHOGWEED_FORLINK)
+VCPKG_TARGET_ARCHITECTURE = @VCPKG_TARGET_ARCHITECTURE@
 
 getopt_SOURCES = getopt.c getopt1.c
 getopt_TARGETS = $(getopt_SOURCES:.c=.$(OBJEXT))
@@ -279,13 +280,13 @@ nettle_OBJS = $(nettle_SOURCES:.c=.$(OBJEXT)) \
 hogweed_OBJS = $(hogweed_SOURCES:.c=.$(OBJEXT)) \
 	       $(OPT_HOGWEED_OBJS) @IF_MINI_GMP@ mini-gmp.$(OBJEXT)
 
-libnettle.a: $(nettle_OBJS)
+@LIBNETTLE_ARCHIVE@: $(nettle_OBJS)
 	-rm -f $@
 	$(AR) $(ARFLAGS) $@ $(nettle_OBJS)
 	$(RANLIB) $@
 	echo nettle > libnettle.stamp
 
-libhogweed.a: $(hogweed_OBJS)
+@LIBHOGWEED_ARCHIVE@: $(hogweed_OBJS)
 	-rm -f $@
 	$(AR) $(ARFLAGS) $@ $(hogweed_OBJS)
 	$(RANLIB) $@
diff --git a/configure.ac b/configure.ac
index c74b266..5fab777 100644
--- a/configure.ac
+++ b/configure.ac
@@ -869,6 +869,26 @@ case "$host_os" in
     LIBHOGWEED_LIBS='libnettle.so $(LIBS)'
     ;;
 esac
+AC_ARG_VAR(VCPKG_TARGET_ARCHITECTURE,[Target architecture])
+AC_ARG_VAR(MSVC_STYLE,[Set to yes to use MSVC filename and option style])
+if test "x$MSVC_STYLE" = "xyes" ; then
+  LIBNETTLE_ARCHIVE='nettle.lib'
+  LIBNETTLE_FORLINK='nettle-$(LIBNETTLE_MAJOR).dll'
+  LIBNETTLE_FILE='nettle.lib'
+  LIBNETTLE_LINK='$(CC) $(CPPFLAGS) -Wl,$(LDFLAGS) -Wl,-DLL -Wl,-IMPLIB:$(LIBNETTLE_FILE) -Wl,-DEF:$(srcdir)/nettle-$(VCPKG_TARGET_ARCHITECTURE).def'
+  LIBNETTLE_LIBS='$(LIBS)'
+  LIBHOGWEED_FILE='hogweed.lib'
+  LIBHOGWEED_ARCHIVE='hogweed.lib'
+  LIBHOGWEED_FORLINK='hogweed-$(LIBHOGWEED_MAJOR).dll'
+  LIBHOGWEED_LINK='$(CC) $(CPPFLAGS) -Wl,$(LDFLAGS) -Wl,-DLL -Wl,-IMPLIB:$(LIBHOGWEED_FILE) -Wl,-DEF:$(srcdir)/hogweed-$(VCPKG_TARGET_ARCHITECTURE).def'
+  LIBHOGWEED_LIBS='$(LIBNETTLE_FILE) $(LIBS)'
+else
+  LIBNETTLE_ARCHIVE='libnettle.a'
+  LIBHOGWEED_ARCHIVE='libhogweed.a'
+  exit 1
+fi
+AC_SUBST(LIBNETTLE_ARCHIVE)
+AC_SUBST(LIBHOGWEED_ARCHIVE)
 
 ASM_SYMBOL_PREFIX=''
 ASM_ELF_STYLE='no'
